FROM python-libindy:latest

ENV HOME=/app
WORKDIR $HOME
USER root

ADD ./src/requirements.txt $HOME/src/
RUN pip install -r src/requirements.txt

ADD ./src ./docker-entrypoint.sh $HOME/
ADD ./site_templates $HOME/site_templates

RUN chgrp -R 0 $HOME \
  && chmod -R g+rwx $HOME

USER 1001

ENTRYPOINT ["./docker-entrypoint.sh"]
CMD ["python3", "manage.py", "runserver", "0.0.0.0:8000"]
